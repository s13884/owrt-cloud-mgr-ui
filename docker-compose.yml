version: "3.9"

services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: openwrt-ui-frontend
    ports:
      - "5173:5173"
    volumes:
      - ./app:/usr/src/app
    working_dir: /usr/src/app
    command: >
      bash -c "
        # if project not yet generated, create it and install deps
        if [ ! -f package.json ]; then
          echo '>>> Generating Vite React + TS project...';
          npm create vite@latest . -- --template react-ts --yes;
          npm install;
        fi;
        echo '>>> Starting dev server';
        npm run dev -- --host 0.0.0.0
      "
